<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema APAE - Escala de Vínculos</title>
    <link rel="stylesheet" href="../Escalas/escalas.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .import-section {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .import-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .import-header h3 {
            margin: 0;
            color: #495057;
        }
        
        .import-controls {
            display: flex;
            gap: 15px;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .file-input-wrapper {
            position: relative;
            display: inline-block;
        }
        
        .file-input {
            position: absolute;
            opacity: 0;
            width: 100%;
            height: 100%;
            cursor: pointer;
        }
        
        .file-input-label {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 10px 16px;
            background: #007bff;
            color: white;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        
        .file-input-label:hover {
            background: #0056b3;
        }
        
        .file-status {
            color: #6c757d;
            font-size: 14px;
        }
        
        .import-format-info {
            background: #e3f2fd;
            border: 1px solid #bbdefb;
            border-radius: 4px;
            padding: 12px;
            margin-top: 15px;
            font-size: 14px;
        }
        
        .import-format-info h4 {
            margin: 0 0 8px 0;
            color: #1976d2;
        }
        
        .import-format-info ul {
            margin: 8px 0 0 20px;
            color: #424242;
        }
        
        .periodo-restriction {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 4px;
            padding: 15px;
            margin: 15px 0;
        }
        
        .periodo-restriction h4 {
            margin: 0 0 10px 0;
            color: #856404;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .periodo-options {
            display: flex;
            gap: 20px;
            margin-top: 10px;
        }
        
        .periodo-option {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .periodo-option input[type="radio"] {
            margin: 0;
        }
        
        .periodo-option label {
            margin: 0;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Sidebar Esquerda -->
        <aside class="sidebar">
            <nav class="menu">
                <ul>
                    <li class="active"><a href="http://127.0.0.1:5500/apae/Escalas/escalas.html"><i class="fas fa-calendar"></i> Escalas</a></li>
                    <li><a href="http://127.0.0.1:5500/apae/Funcionarios/func.html"><i class="fa-solid fa-user-doctor"></i> Funcionários</a></li>
                    <li><a href="http://127.0.0.1:5500/apae/Pacientes/pac.html"><i class="fa-solid fa-person"></i> Pacientes</a></li>
                    <li> <a href="http://127.0.0.1:5500/apae/Configuracoes/config.html"><i class="fas fa-cog"></i> Configurações</a></li>
                </ul>
            </nav>
            <div class="user-profile">
                <div class="avatar">
                    <i class="fas fa-user-circle"></i>
                </div>
                <div class="user-info">
                    <h4>Usuário</h4>
                    <p>Minha Conta</p>
                </div>
            </div>
        </aside>

        <!-- Conteúdo Principal -->
        <main class="main-content">
            <div class="main-header">
                <h1>Escala de Vínculos</h1>
                <button id="novo-paciente-btn" class="btn-primary">
                    <i class="fas fa-plus"></i> Novo Paciente
                </button>
            </div>

            <!-- Seção de Importação -->
            <section class="import-section">
                <div class="import-header">
                    <i class="fas fa-upload"></i>
                    <h3>Importar Escalas</h3>
                </div>
                
                <div class="import-controls">
                    <div class="file-input-wrapper">
                        <input type="file" id="file-import" class="file-input" accept=".csv,.json" />
                        <label for="file-import" class="file-input-label">
                            <i class="fas fa-file-upload"></i>
                            Selecionar Arquivo
                        </label>
                    </div>
                    
                    <button id="import-btn" class="btn-primary" disabled>
                        <i class="fas fa-download"></i> Importar
                    </button>
                    
                    <span id="file-status" class="file-status">Nenhum arquivo selecionado</span>
                </div>
                
                <div class="import-format-info">
                    <h4><i class="fas fa-info-circle"></i> Formato de Importação</h4>
                    <p>Aceita arquivos CSV ou JSON com as seguintes colunas:</p>
                    <ul>
                        <li><strong>nome:</strong> Nome do profissional</li>
                        <li><strong>especialidade:</strong> Especialidade do profissional</li>
                        <li><strong>dia:</strong> Dia da semana (Segunda, Terça, Quarta, Quinta, Sexta)</li>
                        <li><strong>horario:</strong> Horário no formato HH:MM (ex: 08:00)</li>
                        <li><strong>disponivel:</strong> true/false (opcional, padrão: true)</li>
                    </ul>
                </div>
            </section>

            <!-- Lista de Pacientes -->
            <section class="pacientes-section">
                <h2>Pacientes Cadastrados</h2>
                <div id="pacientes-container" class="pacientes-container">
                    <div class="empty-state">
                        <p>Nenhum paciente cadastrado. Adicione um paciente para começar.</p>
                    </div>
                </div>
            </section>

            <!-- Grade de Horários -->
            <div class="semana-controls">
                <button id="semana-anterior" class="btn-secondary">
                    <i class="fas fa-chevron-left"></i> Semana Anterior
                </button>
                <div class="semana-atual">
                    <span id="periodo-semana"></span>
                </div>
                <button id="proxima-semana" class="btn-secondary">
                    Próxima Semana <i class="fas fa-chevron-right"></i>
                </button>
            </div>
            <div class="escala-container">
                <div class="escala-header">
                    <h2>Escala de Vínculos Confirmados</h2>
                </div>
                <div class="escala-grid">
                    <!-- Cabeçalho -->
                    <div class="grid-header horario-header">Horário</div>
                    <div class="grid-header" id="header-dia-1">
                        <div class="dia-nome">Segunda</div>
                        <div class="dia-data" id="data-1"></div>
                    </div>
                    <div class="grid-header" id="header-dia-2">
                        <div class="dia-nome">Terça</div>
                        <div class="dia-data" id="data-2"></div>
                    </div>
                    <div class="grid-header" id="header-dia-3">
                        <div class="dia-nome">Quarta</div>
                        <div class="dia-data" id="data-3"></div>
                    </div>
                    <div class="grid-header" id="header-dia-4">
                        <div class="dia-nome">Quinta</div>
                        <div class="dia-data" id="data-4"></div>
                    </div>
                    <div class="grid-header" id="header-dia-5">
                        <div class="dia-nome">Sexta</div>
                        <div class="dia-data" id="data-5"></div>
                    </div>

                    <!-- Período Manhã -->
                    <div class="periodo-header manha">
                        <i class="fas fa-sun"></i> Manhã (08:00 - 12:00)
                    </div>

                    <!-- Horários da Manhã -->
                    <div class="horario-label">08:00</div>
                    <div class="slot-horario" data-dia="Segunda" data-horario="08:00"></div>
                    <div class="slot-horario" data-dia="Terça" data-horario="08:00"></div>
                    <div class="slot-horario" data-dia="Quarta" data-horario="08:00"></div>
                    <div class="slot-horario" data-dia="Quinta" data-horario="08:00"></div>
                    <div class="slot-horario" data-dia="Sexta" data-horario="08:00"></div>

                    <div class="horario-label">08:30</div>
                    <div class="slot-horario" data-dia="Segunda" data-horario="08:30"></div>
                    <div class="slot-horario" data-dia="Terça" data-horario="08:30"></div>
                    <div class="slot-horario" data-dia="Quarta" data-horario="08:30"></div>
                    <div class="slot-horario" data-dia="Quinta" data-horario="08:30"></div>
                    <div class="slot-horario" data-dia="Sexta" data-horario="08:30"></div>

                    <div class="horario-label">09:00</div>
                    <div class="slot-horario" data-dia="Segunda" data-horario="09:00"></div>
                    <div class="slot-horario" data-dia="Terça" data-horario="09:00"></div>
                    <div class="slot-horario" data-dia="Quarta" data-horario="09:00"></div>
                    <div class="slot-horario" data-dia="Quinta" data-horario="09:00"></div>
                    <div class="slot-horario" data-dia="Sexta" data-horario="09:00"></div>

                    <div class="horario-label">09:30</div>
                    <div class="slot-horario" data-dia="Segunda" data-horario="09:30"></div>
                    <div class="slot-horario" data-dia="Terça" data-horario="09:30"></div>
                    <div class="slot-horario" data-dia="Quarta" data-horario="09:30"></div>
                    <div class="slot-horario" data-dia="Quinta" data-horario="09:30"></div>
                    <div class="slot-horario" data-dia="Sexta" data-horario="09:30"></div>

                    <div class="horario-label">10:00</div>
                    <div class="slot-horario" data-dia="Segunda" data-horario="10:00"></div>
                    <div class="slot-horario" data-dia="Terça" data-horario="10:00"></div>
                    <div class="slot-horario" data-dia="Quarta" data-horario="10:00"></div>
                    <div class="slot-horario" data-dia="Quinta" data-horario="10:00"></div>
                    <div class="slot-horario" data-dia="Sexta" data-horario="10:00"></div>

                    <div class="horario-label">10:30</div>
                    <div class="slot-horario" data-dia="Segunda" data-horario="10:30"></div>
                    <div class="slot-horario" data-dia="Terça" data-horario="10:30"></div>
                    <div class="slot-horario" data-dia="Quarta" data-horario="10:30"></div>
                    <div class="slot-horario" data-dia="Quinta" data-horario="10:30"></div>
                    <div class="slot-horario" data-dia="Sexta" data-horario="10:30"></div>

                    <div class="horario-label">11:00</div>
                    <div class="slot-horario" data-dia="Segunda" data-horario="11:00"></div>
                    <div class="slot-horario" data-dia="Terça" data-horario="11:00"></div>
                    <div class="slot-horario" data-dia="Quarta" data-horario="11:00"></div>
                    <div class="slot-horario" data-dia="Quinta" data-horario="11:00"></div>
                    <div class="slot-horario" data-dia="Sexta" data-horario="11:00"></div>

                    <div class="horario-label">11:30</div>
                    <div class="slot-horario" data-dia="Segunda" data-horario="11:30"></div>
                    <div class="slot-horario" data-dia="Terça" data-horario="11:30"></div>
                    <div class="slot-horario" data-dia="Quarta" data-horario="11:30"></div>
                    <div class="slot-horario" data-dia="Quinta" data-horario="11:30"></div>
                    <div class="slot-horario" data-dia="Sexta" data-horario="11:30"></div>

                    <div class="horario-label">12:00</div>
                    <div class="slot-horario" data-dia="Segunda" data-horario="12:00"></div>
                    <div class="slot-horario" data-dia="Terça" data-horario="12:00"></div>
                    <div class="slot-horario" data-dia="Quarta" data-horario="12:00"></div>
                    <div class="slot-horario" data-dia="Quinta" data-horario="12:00"></div>
                    <div class="slot-horario" data-dia="Sexta" data-horario="12:00"></div>

                    <!-- Período Tarde -->
                    <div class="periodo-header tarde">
                        <i class="fas fa-sun"></i> Tarde (13:00 - 17:00)
                    </div>

                    <!-- Horários da Tarde -->
                    <div class="horario-label">13:00</div>
                    <div class="slot-horario" data-dia="Segunda" data-horario="13:00"></div>
                    <div class="slot-horario" data-dia="Terça" data-horario="13:00"></div>
                    <div class="slot-horario" data-dia="Quarta" data-horario="13:00"></div>
                    <div class="slot-horario" data-dia="Quinta" data-horario="13:00"></div>
                    <div class="slot-horario" data-dia="Sexta" data-horario="13:00"></div>

                    <div class="horario-label">13:30</div>
                    <div class="slot-horario" data-dia="Segunda" data-horario="13:30"></div>
                    <div class="slot-horario" data-dia="Terça" data-horario="13:30"></div>
                    <div class="slot-horario" data-dia="Quarta" data-horario="13:30"></div>
                    <div class="slot-horario" data-dia="Quinta" data-horario="13:30"></div>
                    <div class="slot-horario" data-dia="Sexta" data-horario="13:30"></div>

                    <div class="horario-label">14:00</div>
                    <div class="slot-horario" data-dia="Segunda" data-horario="14:00"></div>
                    <div class="slot-horario" data-dia="Terça" data-horario="14:00"></div>
                    <div class="slot-horario" data-dia="Quarta" data-horario="14:00"></div>
                    <div class="slot-horario" data-dia="Quinta" data-horario="14:00"></div>
                    <div class="slot-horario" data-dia="Sexta" data-horario="14:00"></div>

                    <div class="horario-label">14:30</div>
                    <div class="slot-horario" data-dia="Segunda" data-horario="14:30"></div>
                    <div class="slot-horario" data-dia="Terça" data-horario="14:30"></div>
                    <div class="slot-horario" data-dia="Quarta" data-horario="14:30"></div>
                    <div class="slot-horario" data-dia="Quinta" data-horario="14:30"></div>
                    <div class="slot-horario" data-dia="Sexta" data-horario="14:30"></div>

                    <div class="horario-label">15:00</div>
                    <div class="slot-horario" data-dia="Segunda" data-horario="15:00"></div>
                    <div class="slot-horario" data-dia="Terça" data-horario="15:00"></div>
                    <div class="slot-horario" data-dia="Quarta" data-horario="15:00"></div>
                    <div class="slot-horario" data-dia="Quinta" data-horario="15:00"></div>
                    <div class="slot-horario" data-dia="Sexta" data-horario="15:00"></div>

                    <div class="horario-label">15:30</div>
                    <div class="slot-horario" data-dia="Segunda" data-horario="15:30"></div>
                    <div class="slot-horario" data-dia="Terça" data-horario="15:30"></div>
                    <div class="slot-horario" data-dia="Quarta" data-horario="15:30"></div>
                    <div class="slot-horario" data-dia="Quinta" data-horario="15:30"></div>
                    <div class="slot-horario" data-dia="Sexta" data-horario="15:30"></div>

                    <div class="horario-label">16:00</div>
                    <div class="slot-horario" data-dia="Segunda" data-horario="16:00"></div>
                    <div class="slot-horario" data-dia="Terça" data-horario="16:00"></div>
                    <div class="slot-horario" data-dia="Quarta" data-horario="16:00"></div>
                    <div class="slot-horario" data-dia="Quinta" data-horario="16:00"></div>
                    <div class="slot-horario" data-dia="Sexta" data-horario="16:00"></div>

                    <div class="horario-label">16:30</div>
                    <div class="slot-horario" data-dia="Segunda" data-horario="16:30"></div>
                    <div class="slot-horario" data-dia="Terça" data-horario="16:30"></div>
                    <div class="slot-horario" data-dia="Quarta" data-horario="16:30"></div>
                    <div class="slot-horario" data-dia="Quinta" data-horario="16:30"></div>
                    <div class="slot-horario" data-dia="Sexta" data-horario="16:30"></div>

                    <div class="horario-label">17:00</div>
                    <div class="slot-horario" data-dia="Segunda" data-horario="17:00"></div>
                    <div class="slot-horario" data-dia="Terça" data-horario="17:00"></div>
                    <div class="slot-horario" data-dia="Quarta" data-horario="17:00"></div>
                    <div class="slot-horario" data-dia="Quinta" data-horario="17:00"></div>
                    <div class="slot-horario" data-dia="Sexta" data-horario="17:00"></div>
                </div>
            </div>
        </main>
    </div>

    <!-- Modal para Novo Paciente -->
    <div id="modal-paciente" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Adicionar Novo Paciente</h2>
                <span class="close-modal" id="close-paciente">&times;</span>
            </div>
            <form id="paciente-form">
                <div class="form-group">
                    <label for="nome-paciente">Nome do Paciente</label>
                    <input type="text" id="nome-paciente" placeholder="Digite o nome do paciente" required>
                </div>
                
                <div class="form-group">
                    <label>Especialidades Necessárias</label>
                    <div class="especialidades-grid" id="especialidades-container">
                        <!-- Especialidades serão inseridas via JavaScript -->
                    </div>
                </div>

                <div class="form-group">
                    <label for="observacoes-paciente">Observações</label>
                    <textarea id="observacoes-paciente" placeholder="Observações adicionais" rows="3"></textarea>
                </div>

                <div class="form-group">
                    <label for="data-inicio">Data de Início dos Atendimentos</label>
                    <input type="date" id="data-inicio" required>
                </div>

                <!-- Nova seção para restrições de período -->
                <div class="periodo-restriction">
                    <h4>
                        <i class="fas fa-clock"></i>
                        Restrições de Horário
                    </h4>
                    <p>Como mãe/pai de uma criança com necessidades especiais, você pode ter limitações de deslocamento. Selecione sua preferência:</p>
                    
                    <div class="periodo-options">
                        <div class="periodo-option">
                            <input type="radio" id="periodo-flexivel" name="periodo-preferencia" value="flexivel" checked>
                            <label for="periodo-flexivel">Flexível (manhã e tarde)</label>
                        </div>
                        <div class="periodo-option">
                            <input type="radio" id="periodo-manha" name="periodo-preferencia" value="manha">
                            <label for="periodo-manha">Apenas manhã (08:00 - 12:00)</label>
                        </div>
                        <div class="periodo-option">
                            <input type="radio" id="periodo-tarde" name="periodo-preferencia" value="tarde">
                            <label for="periodo-tarde">Apenas tarde (13:00 - 17:00)</label>
                        </div>
                    </div>
                    
                    <div class="form-group" style="margin-top: 15px;">
                        <label for="dias-preferencia">Dias da Semana Preferenciais (opcional)</label>
                        <div style="display: flex; gap: 15px; flex-wrap: wrap; margin-top: 8px;">
                            <label><input type="checkbox" value="Segunda" name="dias-preferencia"> Segunda</label>
                            <label><input type="checkbox" value="Terça" name="dias-preferencia"> Terça</label>
                            <label><input type="checkbox" value="Quarta" name="dias-preferencia"> Quarta</label>
                            <label><input type="checkbox" value="Quinta" name="dias-preferencia"> Quinta</label>
                            <label><input type="checkbox" value="Sexta" name="dias-preferencia"> Sexta</label>
                        </div>
                    </div>
                </div>

                <div class="form-actions">
                    <button type="submit" class="btn-primary">Adicionar</button>
                    <button type="button" class="btn-secondary" id="cancel-paciente">Cancelar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal para Opções de Escala -->
    <div id="modal-escalas" class="modal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h2>Opções de Escala Geradas</h2>
                <span class="close-modal" id="close-escalas">&times;</span>
            </div>
            <div id="escalas-container">
                <!-- Opções de escala serão inseridas via JavaScript -->
            </div>
        </div>
    </div>

    <script src="./escalas.js"></script>
</body>
</html>
